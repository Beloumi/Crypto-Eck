package cologne.eck.dr.op.crypto.password_hashing.test;


/**
 * @author Axel von dem Bruch
 */

/*
 * Test class for PomeloKDF
 * Copyright (C) 2015  Axel von dem Bruch
 * 
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 * 
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 * 
 * See:  https://www.gnu.org/licenses/lgpl-2.1.html
 * You should have received a copy of the GNU General Public License 
 * along with this library.
 */



import cologne.eck.dr.op.crypto.password_hashing.PomeloKDF;

public class TestPomeloKDF {
	
	private final static String[][] TEST_VECTORS = {

		//first three test vectors:
		{
			"0", //m_cost			
			"5", // t_cost
			"64", // keylen
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f"
			+ "202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f",// password
			"", //salt
			"b52f245c3fa893092562d2e146290e16b3f5b6e1e2561894a41f28872ca280130f68f657ac50d8fd043593fddf3d9e83ddf08e3046b74c8220967e9f4e17028f"
		},
		{
			"0", //m_cost			
			"5", // t_cost
			"128", // keylen
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f"
			+ "202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f",// password
			"", //salt
			"b52f245c3fa893092562d2e146290e16b3f5b6e1e2561894a41f28872ca280130f68f657ac50d8fd043593fddf3d9e83ddf08e3046b74c8220967e9f4e17028f1f8e0a7f4ceeb1cc633d77faaf8475e63ae8a895bbd764865b8cc2d68fa68603ee1aa459c7a561d1e60d9928816e624193e97d66b754fdb724084c02f08f43d1"
		},		
		{
			"0", //m_cost			
			"5", // t_cost
			"192", // keylen
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f"
			+ "202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f",// password
			"", //salt
			"b52f245c3fa893092562d2e146290e16b3f5b6e1e2561894a41f28872ca280130f68f657ac50d8fd043593fddf3d9e83ddf08e3046b74c8220967e9f4e17028f1f8e0a7f4ceeb1cc633d77faaf8475e63ae8a895bbd764865b8cc2d68fa68603ee1aa459c7a561d1e60d9928816e624193e97d66b754fdb724084c02f08f43d18f2a7613b13b71dbb575475119bb8de393c158b97db9e12358903bbf924209cbba7cd031f638865796cd55d321d8de51c4c7ee9f825647b8afd4abbfbd3bdae8"
		},
	
		// some other vectors...:
		{
			"0", //m_cost			
			"5", // t_cost
			"576", // keylen
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f",// password
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f", //salt
			"c7988546c0021414e60a88e8f2dfa7a052c70b8d26a3ca34d1204f4b56f3e4d0"
			+ "763fa2892eb9e08b7f216f97463650d9dcc325f5e4cd6fa380fadb558c5e182e"
			+ "8020bfb8b315584df0ddc4df01ae3717e2f11b405173cd8d2c1ac61ce34c8e0f"
			+ "f4a125ccadc09ec59264adf600631428a96aa22807ff88625ac669f75e5c99f2"
			+ "148f3882aba3f41c5d8494ca408f7927a7cf1abda9b782807cc8a9eb7339ccc1c"
			+ "5652bf90a7d0008be097cdc810a2e28b2973e7edf07d6ed0d8ec3fe564d9656b5"
			+ "f14a7f6a93b82b92b45e16ec22e87b8c414808ac7308f8f530a3e01518eacd5ad"
			+ "bd29e1b3803842002c583ec0de3babf1cf8165d066b299a5305ced0f9cded68bf"
			+ "f78d0debc19ff947dc5466699cd3678951165be458dcdca5831387d5f38eeb089"
			+ "9f03fd5f39945bbed2fe25a92f10f342775d8ae38e729808416e79c284a280994"
			+ "8107e20e25fe303ebc9e8dde1e740202dd252ba3d9421e0edeb20fa951f8361b9"
			+ "ea64544ac44557277f4bf2dcc8f3febaabd126891e928b594f6d7718399c7cf5e"
			+ "7fd7e2258230ca86d48d958c14c4659f7f4e203c2ecebd45f6f1b12830f101e118"
			+ "be087773f404f09c82847caa15dd512e8d1059edf7fcb07f219e3a4c46f21b15c7"
			+ "0654f0f6a3399d803a80b22b66a2938f07286040820477d612e27f6643a745f864"
			+ "2652098b6991afe8b9817c4715c28b016adf4ae826c4082126c6e479d822446add5"
			+ "8ea2224db3da1c342ba8fc67ea12af77db502a71725558d2d844fba0ab8cb008e52"
			+ "c07674be9c38a2ac97b634eb16a1b280e8f461092200"
		},
		{
			"1", //m_cost			
			"5", // t_cost
			"960", // keylen
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebf",// password
			"", //salt
			"8c7dca0c88758577c069b20c3d9ee18e619d90b0381cf6cf2703ab0da0b2bd6825054d2d9a2dbdff9c91c96efdeac0c57bbad53daca809e13ced8309f08156e97f9f13bf5a360f616d8baa8333ce0c71897e38e0acbacf51e8c703bba2ca1c0bd08a145d7eecb4e730cab5abbbad8290355d0b8929d6bf2265c4647aa893308419c302b30ba1c43cd8dfd779bf0c5fcd89034126187ec192e35489a4526ee758862f93bd6420113e0abfb02709f197616015e58fbbb101d0a70e6864a6d20c1b2a776ffcabbec7ead11d3968aa0ef5fdf9f40168907e0d3af296827438412b1dbfc1b89f1adc69c2bec28eb6750fa07b4aee31835670ef77b4c358bf80ea62a4c621ce7adb31a76f8171843f7e655d4670bff948e0429f479ca4b51f17a858ea05eb3d70df96679502893097d4e49fc2053ee97059d69c3c5ced4ef27fc087028d49c6b408f69a88dfaa76620bd29900a96125364082728b354119f7f20400ef95dc5699eb7d8a4d659c1f60c7a5c3ab289bede693ae7fabaf6d59240f99bd05f533670d76a177fcafd4717642b7fe2c9683d9bf519df1741dc3d5c068907755610486d6a0a64aa25ba7a828bdcc36f5abbfdd92480120a0b77b23a4eeb24ed8c101f03955d596cecba62b6cc68eac056e112d90125762d52b79a03858fc9e1b844fb84f70f8dc670f38ffff8d61e63fde49868b5ab8324349fc6bb75d732519e59737b0d9b0d78d9de096302be5e550a9024c2646631c4754bbde8b479ceb495a0b4eb3f41a27405f947f5b9d62ae3e2b4a7317ddd73351fdcbf8879ec06cff6ee6107e1326dad4da2e0c96ebb25b7fdd9193de470433b67d533d5b6bb169eab04ae53202187a60ad8c0e6c06a8c8eece22fe159502d535c2f223ecb0c873ef07e87e68657ef94d2a5f883c2a328ee24def014e25951b694639b2db9e1c55f11928aebbb6c20df56ff5e0027ad87489e5a19e3b101cbc10340411b672d55d1d70214d517f069e5446bbe96442f65f0cda25593f52c2ff3f4907bc169484f5d8e16a56fb592d3c65dee7cd2c3317a499748ce9aa362f0fd4555ea6d830dbf95d26bf748c2a12261c568ebc16a3cc091af2e37d46c376a07c922b53e8776b35af089d23165b635e550806280f9e36f19f73e3de5c0de7a14969f86c75f3352cb6c1f96a8abb027dd73f2bf6f4d87863781999976b15d5e94a9afa869081ff0184c9a4fef7a4a3d78b740bb8f3fd231639fdee606e89fa943e2ae5f8fa90433122e2bf83d04ff0bd00898ac574a8edc79a567f2cef0062b7194f820768aba63174a841a60ba46fd9d3a5fe11b715ad1e636ad981b8e96fd05a707a0b94f9afc03b"
		},

		// the last three test vectors:
		{
			"1", //m_cost			
			"6", // t_cost
			"896", // keylen
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff",// password
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f", //salt
			"98a9eb9fb9e79b19bba9e3bfb89466cb13c4a8e7984f51f4caa2258865350227a650242af805d69266bef4c38259c8d87ab28195bef38f73864b5622fcfdfcb9100f7538a0331b5c7f0e62980fac1c787f058f6540adda8305665308edd58470fbdbad5bbdea2fc836d8d7044065074de1e835becfaee74e1a676c20e910a2a70e54336aed4d1edef7d2fe1aec7d4146a055eb12f2d2b866ffde93cdaa49f287c98d35753f1dc65f15e59362f84c36aaa7de154169ec3dcfce6620beeecb9790dca06c475b71ebc1708b22ee002f2113127e8e79e08f5730428229a89654f0be8d0e5242b576fd2c8cb8b2d92633c96c41237258278f80731746bd95fb2dd4a1db4645036c1ed13e94eb25692e3d79e3805db59cd21c898d5955e53cb9338a3edf526361fe69ba1f2429f2069784b750402b9016e62135d6899e108a8df7a0e38c2b1256312f5341bab148bc87e7b982fd2c80188ac9d15dd26154bd8e37f44f2a39c10c0319a94fdef80c2048cfcd4cb4d4aace12c00754b9194133690cd1332c9fd6593e8afe1197619fb58996fdab6c377779db25d3e33b40369b9900f742fbdde8e2304b69850bf223aebe1951bdf7cce1de4ea9a20b635041b59d77353fded4b682413e9d1fb83128b4033767b783aff66dc1696b8ca205c28b1ee4dc31cd98eb7ebc795ce4129ca25dbd819b3638343e60cf31543ab72052fcd5d95b01f7c252d805faecc495d4c1cef9dc6aa83f9e6c5187933769afae133afaa5d42d20b3bd087912fd6747855e1e564a99cf5be13223f755f8c9817d36b284574d1c7b7cc40a6b1a9f15be0888647e3a077ba99d0bb91ef33c747a3a06571fd60d39d876a9ee3961c12054d00c7dc1862d054a1f86e3001828f2a769827e09c1569469ce9bcb45185e2c096198d61852cb9900ae7eda4fa6c2cc9af1edbe55761672f93b2f15a227b6ac12dbb25f76bd87136afba3a8ae3ed919c4a1d4ae020bbbba3ac0e58643a897650ed17ea0d08b5e666db2003cac198b50bb4c25a1a208ec54c0c037536b4134b130bd27e4fc6456c5c0f31ffa66b5a5866c94497a1ee1a156d0c094e822b64c9b6516b276ee7b08a0404ef1cc45bb0c158adf985a23b8542998c806c8ff682dec6eb599dce150091ea1f3791bb69a9be2a7f3d735956074c315421055fc51c832376e68b1961b45531675a43de11fc2c27b0c560f93427d23c5e64ad96280a3ef92ac9f81e9d707c3e343d89a1a91f1e6676d44740f2096ce"
		},
		{
			"1", //m_cost			
			"6", // t_cost
			"960", // keylen
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff",// password
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f", //salt
			"98a9eb9fb9e79b19bba9e3bfb89466cb13c4a8e7984f51f4caa2258865350227a650242af805d69266bef4c38259c8d87ab28195bef38f73864b5622fcfdfcb9100f7538a0331b5c7f0e62980fac1c787f058f6540adda8305665308edd58470fbdbad5bbdea2fc836d8d7044065074de1e835becfaee74e1a676c20e910a2a70e54336aed4d1edef7d2fe1aec7d4146a055eb12f2d2b866ffde93cdaa49f287c98d35753f1dc65f15e59362f84c36aaa7de154169ec3dcfce6620beeecb9790dca06c475b71ebc1708b22ee002f2113127e8e79e08f5730428229a89654f0be8d0e5242b576fd2c8cb8b2d92633c96c41237258278f80731746bd95fb2dd4a1db4645036c1ed13e94eb25692e3d79e3805db59cd21c898d5955e53cb9338a3edf526361fe69ba1f2429f2069784b750402b9016e62135d6899e108a8df7a0e38c2b1256312f5341bab148bc87e7b982fd2c80188ac9d15dd26154bd8e37f44f2a39c10c0319a94fdef80c2048cfcd4cb4d4aace12c00754b9194133690cd1332c9fd6593e8afe1197619fb58996fdab6c377779db25d3e33b40369b9900f742fbdde8e2304b69850bf223aebe1951bdf7cce1de4ea9a20b635041b59d77353fded4b682413e9d1fb83128b4033767b783aff66dc1696b8ca205c28b1ee4dc31cd98eb7ebc795ce4129ca25dbd819b3638343e60cf31543ab72052fcd5d95b01f7c252d805faecc495d4c1cef9dc6aa83f9e6c5187933769afae133afaa5d42d20b3bd087912fd6747855e1e564a99cf5be13223f755f8c9817d36b284574d1c7b7cc40a6b1a9f15be0888647e3a077ba99d0bb91ef33c747a3a06571fd60d39d876a9ee3961c12054d00c7dc1862d054a1f86e3001828f2a769827e09c1569469ce9bcb45185e2c096198d61852cb9900ae7eda4fa6c2cc9af1edbe55761672f93b2f15a227b6ac12dbb25f76bd87136afba3a8ae3ed919c4a1d4ae020bbbba3ac0e58643a897650ed17ea0d08b5e666db2003cac198b50bb4c25a1a208ec54c0c037536b4134b130bd27e4fc6456c5c0f31ffa66b5a5866c94497a1ee1a156d0c094e822b64c9b6516b276ee7b08a0404ef1cc45bb0c158adf985a23b8542998c806c8ff682dec6eb599dce150091ea1f3791bb69a9be2a7f3d735956074c315421055fc51c832376e68b1961b45531675a43de11fc2c27b0c560f93427d23c5e64ad96280a3ef92ac9f81e9d707c3e343d89a1a91f1e6676d44740f2096cef70171dc44c8e9add4548287e5dee40b29542b1184db1400fe40051e1da665fee7df2175d3d70614ed8ec17c7a37ebd9305082fe0797940e1d807d186b6b24cc"
		},
		{
			"1", //m_cost			
			"6", // t_cost
			"1024", // keylen
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f505152535455565758595a5b5c5d5e5f606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeafb0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff",// password
			"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f", //salt
			"98a9eb9fb9e79b19bba9e3bfb89466cb13c4a8e7984f51f4caa2258865350227a650242af805d69266bef4c38259c8d87ab28195bef38f73864b5622fcfdfcb9100f7538a0331b5c7f0e62980fac1c787f058f6540adda8305665308edd58470fbdbad5bbdea2fc836d8d7044065074de1e835becfaee74e1a676c20e910a2a70e54336aed4d1edef7d2fe1aec7d4146a055eb12f2d2b866ffde93cdaa49f287c98d35753f1dc65f15e59362f84c36aaa7de154169ec3dcfce6620beeecb9790dca06c475b71ebc1708b22ee002f2113127e8e79e08f5730428229a89654f0be8d0e5242b576fd2c8cb8b2d92633c96c41237258278f80731746bd95fb2dd4a1db4645036c1ed13e94eb25692e3d79e3805db59cd21c898d5955e53cb9338a3edf526361fe69ba1f2429f2069784b750402b9016e62135d6899e108a8df7a0e38c2b1256312f5341bab148bc87e7b982fd2c80188ac9d15dd26154bd8e37f44f2a39c10c0319a94fdef80c2048cfcd4cb4d4aace12c00754b9194133690cd1332c9fd6593e8afe1197619fb58996fdab6c377779db25d3e33b40369b9900f742fbdde8e2304b69850bf223aebe1951bdf7cce1de4ea9a20b635041b59d77353fded4b682413e9d1fb83128b4033767b783aff66dc1696b8ca205c28b1ee4dc31cd98eb7ebc795ce4129ca25dbd819b3638343e60cf31543ab72052fcd5d95b01f7c252d805faecc495d4c1cef9dc6aa83f9e6c5187933769afae133afaa5d42d20b3bd087912fd6747855e1e564a99cf5be13223f755f8c9817d36b284574d1c7b7cc40a6b1a9f15be0888647e3a077ba99d0bb91ef33c747a3a06571fd60d39d876a9ee3961c12054d00c7dc1862d054a1f86e3001828f2a769827e09c1569469ce9bcb45185e2c096198d61852cb9900ae7eda4fa6c2cc9af1edbe55761672f93b2f15a227b6ac12dbb25f76bd87136afba3a8ae3ed919c4a1d4ae020bbbba3ac0e58643a897650ed17ea0d08b5e666db2003cac198b50bb4c25a1a208ec54c0c037536b4134b130bd27e4fc6456c5c0f31ffa66b5a5866c94497a1ee1a156d0c094e822b64c9b6516b276ee7b08a0404ef1cc45bb0c158adf985a23b8542998c806c8ff682dec6eb599dce150091ea1f3791bb69a9be2a7f3d735956074c315421055fc51c832376e68b1961b45531675a43de11fc2c27b0c560f93427d23c5e64ad96280a3ef92ac9f81e9d707c3e343d89a1a91f1e6676d44740f2096cef70171dc44c8e9add4548287e5dee40b29542b1184db1400fe40051e1da665fee7df2175d3d70614ed8ec17c7a37ebd9305082fe0797940e1d807d186b6b24cc08d4883b8f84e336a4723c3d0e2f879550b8d8ffaac0aa6ad1f77c94f52a353d397856cdf1333b99a23c903d75e30f0500c32678ec288d07e47c0f79af37f650"
		},
	};

	
	private final static char[] HEX_ARRAY = "0123456789ABCDEF".toCharArray();
	private static String bytes2hex(byte[] bytes) {
	    char[] hexChars = new char[bytes.length * 2];
	    for ( int j = 0; j < bytes.length; j++ ) {
	        int v = bytes[j] & 0xFF;
	        hexChars[j * 2] = HEX_ARRAY[v >>> 4];
	        hexChars[j * 2 + 1] = HEX_ARRAY[v & 0x0F];
	    }
	    return new String(hexChars);
	}
	public final static byte[] hex2bytes(String hexString) {

		byte[] byteArray = new byte[hexString.length() / 2];// 2 Character = 1 Byte
			int len = hexString.length();
			if ( (len & 1) == 1){ 
				System.err.println("Illegal Argument (Function hexStringToBytes): HexString is not even");
				return byteArray; // return null-Array
			}
			final char [] hexCharArray = hexString.toCharArray ();
			for (int i = 0; i < hexString.length(); i+=2) {
				// 1. char in hex <<4, 2. char in hex
				byteArray[i / 2] = (byte) ((Character.digit (hexCharArray[i], 16) << 4) 
								+ Character.digit (hexCharArray[i + 1], 16));
			}		
			return byteArray;
	}
	
	private final static void testOfficialVectors(){
		
		for (int i = 0; i < TEST_VECTORS.length; i++) {//

			int m_cost = Integer.parseInt(TEST_VECTORS[i][0]);
			int t_cost = Integer.parseInt(TEST_VECTORS[i][1]);		
			int keylen = Integer.parseInt(TEST_VECTORS[i][2]);			
			byte[] pwd = hex2bytes(TEST_VECTORS[i][3]);
			byte[] salt = hex2bytes(TEST_VECTORS[i][4]);

			PomeloKDF pom = new PomeloKDF(true);		

			byte[] out = null;
			try {
				out = pom.deriveKey(keylen, pwd, salt, t_cost, m_cost);
			} catch (Exception e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}

			
			if (bytes2hex(out).toUpperCase().equals(TEST_VECTORS[i][5].toUpperCase())){
				System.out.println("Vector " + i + " ok");
			} else {
				System.out.println("Vector " + i + " failed! \n result:");
				System.out.println(bytes2hex(out).toUpperCase() );
				System.out.println("Test vector: \n" +TEST_VECTORS[i][5].toUpperCase() );
			}
		}
	}


	private final static void testPerformance(){
				
		long start = System.currentTimeMillis(); // start
		
		int m_cost = 12;
		int t_cost = 0;			
		byte[] pwd = hex2bytes("000102030405060708090a0b0c0d0e0f10111213141516171819");
		byte[] salt = hex2bytes("a0b0c0d0e0f101112131415161718191a1b1c1d1e1");
		
		byte[] out = null;		
		PomeloKDF pom = null;
		
		for(int i = 0; i <=1024; i += 128){
			
			pom = new PomeloKDF(false);	
			out = new byte[i];
			
			try {
				out = pom.deriveKey(
					i,  
					pwd, 
					salt, 
					t_cost,  
					m_cost);
			} catch (Exception e1) {
				// TODO Auto-generated catch block
				e1.printStackTrace();
			}
			System.out.println("outlen: " + i + "\ntime in ms: " + ((System.currentTimeMillis() - start)/1));//Endpunkt
			start = System.currentTimeMillis(); // start
			System.out.println(bytes2hex(out).toUpperCase() );
		} 
	}

	public static void main(String[] args) {
		
		testOfficialVectors();
		testPerformance();
	}
}
